TRUNCATE TABLE pda.pda_malpred_hive;

LOAD DATA INPATH '/pda/malware_prediction/'
OVERWRITE INTO TABLE pda.pda_malpred_hive;

INSERT OVERWRITE DIRECTORY '/pda/hive/result/hive_task1'
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
STORED AS TEXTFILE

SELECT Census_TotalPhysicalRAM,COUNT(*) as cnt 
FROM pda.pda_malpred_hive 
WHERE HasDetections = 1 
GROUP BY Census_TotalPhysicalRAM ORDER BY cnt DESC LIMIT 20;

INSERT OVERWRITE DIRECTORY '/pda/hive/result/hive_task2'
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
STORED AS TEXTFILE

SELECT Census_PrimaryDiskTypeName,Processor,COUNT(*) as cnt 
FROM pda.pda_malpred_hive 
WHERE HasDetections = 1 
GROUP BY Census_PrimaryDiskTypeName,Processor;

