USE pda_mstr;

DROP TABLE IF EXISTS malware_prediction;

CREATE TABLE IF NOT EXISTS malware_prediction (
	MachineId INTEGER AUTO_INCREMENT
	,IsBeta INTEGER
	,AVProductStatesIdentifier DOUBLE
	,AVProductsInstalled DOUBLE
	,AVProductsEnabled DOUBLE
	,HasTpm DOUBLE
	,Platform VARCHAR(100)
	,Processor VARCHAR(100)
	,OsVer VARCHAR(100)
	,OsBuild DOUBLE
	,OsSuite DOUBLE
	,OsPlatformSubRelease VARCHAR(100)
	,IsProtected DOUBLE
	,Firewall DOUBLE
	,UacLuaenable DOUBLE
	,Census_DeviceFamily VARCHAR(100)
	,Census_ProcessorCoreCount DOUBLE
	,Census_ProcessorManufacturerIdentifier DOUBLE
	,Census_ProcessorModelIdentifier DOUBLE
	,Census_PrimaryDiskTotalCapacity DOUBLE
	,Census_PrimaryDiskTypeName VARCHAR(100)
	,Census_SystemVolumeTotalCapacity DOUBLE
	,Census_HasOpticalDiskDrive INTEGER
	,Census_TotalPhysicalRAM DOUBLE
	,Census_PowerPlatformRoleName VARCHAR(100)
	,Census_InternalBatteryNumberOfCharges DOUBLE
	,Census_OSArchitecture VARCHAR(100)
	,Census_OSEdition VARCHAR(100)
	,Census_OSWUAutoUpdateOptionsName VARCHAR(100)
	,Census_IsPortableOperatingSystem INTEGER
	,Census_FirmwareManufacturerIdentifier DOUBLE
	,Census_IsSecureBootEnabled INTEGER
	,Census_IsVirtualDevice DOUBLE
	,Census_IsTouchEnabled INTEGER
	,Census_IsPenCapable INTEGER
	,Census_IsAlwaysOnAlwaysConnectedCapable DOUBLE
	,Wdft_IsGamer DOUBLE
	,Census_InternalPrimaryDiagonalDisplaySizeInInches DOUBLE
	,Census_MDC2FormFactor VARCHAR(100)
	,Census_OSSkuName VARCHAR(100)
	,SkuEdition VARCHAR(100)
	,ProductName VARCHAR(100)
	,HasDetections INTEGER,
	PRIMARY KEY (MachineId)
);

LOAD DATA LOCAL INFILE '/home/hduser/project/clean_data/df_pda_malware_prediction.csv'
INTO TABLE malware_prediction 
FIELDS TERMINATED BY ','
LINES TERMINATED BY '\n'
IGNORE 1 ROWS;
