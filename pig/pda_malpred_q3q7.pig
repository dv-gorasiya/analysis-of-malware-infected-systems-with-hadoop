full_load = LOAD 'hdfs://localhost:54310/pda/malware_prediction/' USING PigStorage(',')
AS (
	IsBeta:int
	,AVProductStatesIdentifier:double
	,AVProductsInstalled:double
	,AVProductsEnabled:double
	,HasTpm:double
	,Platform:chararray
	,Processor:chararray
	,OsVer:chararray
	,OsBuild:double
	,OsSuite:double
	,OsPlatformSubRelease:chararray
	,IsProtected:double
	,Firewall:double
	,UacLuaenable:double
	,Census_DeviceFamily:chararray
	,Census_ProcessorCoreCount:double
	,Census_ProcessorManufacturerIdentifier:double
	,Census_ProcessorModelIdentifier:double
	,Census_PrimaryDiskTotalCapacity:double
	,Census_PrimaryDiskTypeName:chararray
	,Census_SystemVolumeTotalCapacity:double
	,Census_HasOpticalDiskDrive:int
	,Census_TotalPhysicalRAM:double
	,Census_PowerPlatformRoleName:chararray
	,Census_InternalBatteryNumberOfCharges:double
	,Census_OSArchitecture:chararray
	,Census_OSEdition:chararray
	,Census_OSWUAutoUpdateOptionsName:chararray
	,Census_IsPortableOperatingSystem:int
	,Census_FirmwareManufacturerIdentifier:double
	,Census_IsSecureBootEnabled:int
	,Census_IsVirtualDevice:double
	,Census_IsTouchEnabled:int
	,Census_IsPenCapable:int
	,Census_IsAlwaysOnAlwaysConnectedCapable:double
	,Wdft_IsGamer:double
	,Census_InternalPrimaryDiagonalDisplaySizeInInches:double
	,Census_MDC2FormFactor:chararray
	,Census_OSSkuName:chararray
	,SkuEdition:chararray
	,ProductName:chararray
	,HasDetections:int
);
	
pig_query3 = FILTER full_load BY AVProductsEnabled == 0.0  AND Firewall == 0.0;

pig_query3_grpd = group pig_query3 by HasDetections;

pig_query3_by = FOREACH pig_query3_grpd GENERATE group, COUNT(pig_query3);

STORE pig_query3_by INTO 'hdfs://localhost:54310/pda/result/pig_query3_by' USING PigStorage (',');

pig_query7 = FILTER full_load BY Wdft_IsGamer == 1.0;

pig_query7_grpd = group pig_query7 by HasDetections;

pig_query7_by = FOREACH pig_query7_grpd GENERATE group,COUNT(pig_query7);

STORE pig_query7_by INTO 'hdfs://localhost:54310/pda/result/pig_query7_by' USING PigStorage (',');

